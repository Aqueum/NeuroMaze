<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeuroMaze Game</title>
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f4f4f4;
        }
        canvas {
            border: 1px solid #000;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <script>
// Canvas Game: First Person Maze

// Initialize canvas and game variables
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
canvas.width = 800;
canvas.height = 600;

let currentPosition = 0;
let mazeLog = [];
const maze = [ // Example maze structure
  { left: 1, right: 2 }, // Node 0
  { left: 3, right: 4 }, // Node 1
  { left: 5, right: 6 }, // Node 2
  { left: null, right: null }, // Node 3 (dead end)
  { left: null, right: null }, // Node 4 (dead end)
  { left: null, right: null }, // Node 5 (dead end)
  { left: null, right: null }  // Node 6 (dead end)
];

// Draw game scene
function drawScene() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Visual elements for the maze
  ctx.fillStyle = "#000";
  ctx.font = "24px Arial";
  ctx.textAlign = "center";

  ctx.fillText("You are at position " + currentPosition, canvas.width / 2, canvas.height / 2 - 50);
  ctx.fillText("Press Left or Right to choose a path", canvas.width / 2, canvas.height / 2);

  ctx.fillStyle = "#007BFF";
  ctx.fillRect(canvas.width / 2 - 150, canvas.height / 2 + 50, 100, 50);
  ctx.fillRect(canvas.width / 2 + 50, canvas.height / 2 + 50, 100, 50);

  ctx.fillStyle = "#FFF";
  ctx.fillText("Left", canvas.width / 2 - 100, canvas.height / 2 + 85);
  ctx.fillText("Right", canvas.width / 2 + 100, canvas.height / 2 + 85);
}

// Handle user input
function handleKeyDown(event) {
  if (event.key === "ArrowLeft" || event.key === "ArrowRight") {
    const choice = event.key === "ArrowLeft" ? "left" : "right";
    mazeLog.push(choice);

    const nextPosition = maze[currentPosition][choice];
    if (nextPosition === null) {
      alert("Dead end! Game over.");
      logDecisions();
      resetGame();
    } else {
      currentPosition = nextPosition;
      drawScene();
    }
  }
}

// Log decisions to CSV
function logDecisions() {
  const csvContent = mazeLog.map((direction, index) => `${index + 1},${direction}`).join("\n");
  const fileName = "maze_log.csv";

  if (window.showSaveFilePicker) {
    // Use File System Access API if supported
    window.showSaveFilePicker({
      suggestedName: fileName,
      types: [
        {
          description: "CSV Files",
          accept: { "text/csv": [".csv"] }
        }
      ]
    }).then(async (fileHandle) => {
      const writable = await fileHandle.createWritable();
      await writable.write(new Blob(["Turn,Direction\n" + csvContent], { type: "text/csv;charset=utf-8;" }));
      await writable.close();
    }).catch(console.error);
  } else {
    // Fallback to downloading file
    const blob = new Blob(["Turn,Direction\n" + csvContent], { type: "text/csv;charset=utf-8;" });
    const url = URL.createObjectURL(blob);
    const link = document.createElement("a");
    link.setAttribute("href", url);
    link.setAttribute("download", fileName);
    link.style.display = "none";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
  }
}

// Reset the game
function resetGame() {
  currentPosition = 0;
  mazeLog = [];
  drawScene();
}

// Start the game
window.addEventListener("keydown", handleKeyDown);
drawScene();
    </script>
</body>
</html>
